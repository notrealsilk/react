# ìµœì í™”

ì›¹ ì„œë¹„ìŠ¤ì˜ ì„±ëŠ¥ ê°œì„ 

## useMemo

- ë©”ëª¨ì´ì œì´ì…˜ì„ ê¸°ë°˜ìœ¼ë¡œ ë™ì¼í•œ ì—°ì‚° ë°˜ë³µ ì•ˆí•˜ë„ë¡ í•˜ê¸°

- ë¶ˆí•„ìš”í•œ ì—°ì‚° ì¤„ì´ê¸°

---

#### 1. ì½”ë“œ ì ìš©

1. **Todo ìƒíƒœ ë¶„ì„ (`useMemo`)**:

   - ë“±ë¡ëœ Todoì˜ **ì „ì²´ ê°œìˆ˜**, **ì™„ë£Œëœ ê°œìˆ˜**, **ë¯¸ì™„ë£Œëœ ê°œìˆ˜**ë¥¼ ê³„ì‚°.
   - **ì½”ë“œ**:

     ```js
     const { totalCount, doneCount, notDoneCount } = useMemo(() => {
       console.log("getAnalyzedData í˜¸ì¶œ!")
       const totalCount = todos.length // ì „ì²´ ê°œìˆ˜
       const doneCount = todos.filter((todo) => todo.isDone).length // ì™„ë£Œëœ ê°œìˆ˜
       const notDoneCount = totalCount - doneCount // ë¯¸ì™„ë£Œëœ ê°œìˆ˜

       return { totalCount, doneCount, notDoneCount }
     }, [todos]) // ì˜ì¡´ì„± ë°°ì—´ì— todos ì¶”ê°€
     ```

2. **ë°ì´í„° ê²€ìƒ‰ê³¼ í•„í„°ë§**:

   - **ê²€ìƒ‰ì–´ ì…ë ¥**ì— ë”°ë¼ Todo ë°ì´í„°ë¥¼ í•„í„°ë§.
   - í•„í„°ë§ëœ ë°ì´í„°ë¥¼ ë Œë”ë§.
   - **ì½”ë“œ**:

     ```js
     const getFilteredData = () => {
       if (search === "") {
         return todos
       }
       return todos.filter((todo) => todo.content.toLowerCase().includes(search.toLowerCase()))
     }

     const filteredTodos = getFilteredData()
     ```

3. **ë Œë”ë§**:
   - **ë¶„ì„ëœ ë°ì´í„°**ë¥¼ UIë¡œ ì¶œë ¥:
     ```js
     <div>
       <div>total: {totalCount}</div>
       <div>done: {doneCount}</div>
       <div>notDone: {notDoneCount}</div>
     </div>
     ```

---

#### 2. ì£¼ìš” ì½”ë“œ ë¹„êµ

| ê¸°ëŠ¥             | `useMemo` ì ìš© ì „         | `useMemo` ì ìš© í›„                   |
| ---------------- | ------------------------- | ----------------------------------- |
| ë°ì´í„° ë¶„ì„      | ë§¤ ë Œë”ë§ë§ˆë‹¤ ê³„ì‚°        | `todos` ë³€ê²½ ì‹œì—ë§Œ ê³„ì‚°            |
| ì„±ëŠ¥ ìµœì í™”      | ê³„ì‚° ë°˜ë³µìœ¼ë¡œ ë¹„íš¨ìœ¨ ë°œìƒ | ë©”ëª¨ì´ì œì´ì…˜ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ê³„ì‚° ë°©ì§€ |
| ì˜ì¡´ì„± ë°°ì—´ ê´€ë¦¬ | N/A                       | `[todos]`ë¡œ ì˜ì¡´ì„± ëª…ì‹œ             |

---

#### 3. ì£¼ìš” ë³µìŠµ í¬ì¸íŠ¸

1. **`useMemo` ë¬¸ë²•**:

   ```js
   const memoizedValue = useMemo(() => {
     // ì—°ì‚° ìˆ˜í–‰
     return ê³„ì‚°ëœ ê°’;
   }, [ì˜ì¡´ì„± ë°°ì—´]); // ì˜ì¡´ì„± ê°’ì´ ë³€ê²½ë  ë•Œë§Œ ì¬ê³„ì‚°
   ```

2. **ì ìš© ìœ„ì¹˜**:

   - **ì—°ì‚° ë¹„ìš©ì´ í° ê³„ì‚°**ì´ë‚˜ **ë™ì¼í•œ ê°’ì˜ ë°˜ë³µì ì¸ ê³„ì‚°**ì„ í”¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©.

3. **ì„±ëŠ¥ ìµœì í™” íš¨ê³¼**:
   - ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ë°©ì§€.
   - íŠ¹ì • ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§Œ ê³„ì‚° ìˆ˜í–‰.

---

#### 4. ì´ ì½”ë“œë¥¼ í™œìš©í•œ í•™ìŠµ í¬ì¸íŠ¸

- **Todo ìƒíƒœ ë¶„ì„**:
  - ì™„ë£Œëœ Todo, ë¯¸ì™„ë£Œëœ Todo, ì „ì²´ Todo ê°œìˆ˜ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°.
- **ê²€ìƒ‰ê³¼ í•„í„°ë§**:
  - `filteredTodos`ë¡œ í•„í„°ë§ëœ ë°ì´í„°ë¥¼ ë Œë”ë§.
- **UI ì„±ëŠ¥ ìµœì í™”**:
  - ê³„ì‚°ì´ ìì£¼ í˜¸ì¶œë˜ì§€ ì•Šë„ë¡ `useMemo`ë¡œ ìµœì í™”.

---

## React.memoì™€ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ìµœì í™”

- ì»´í¬ë„ŒíŠ¸ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì•„ ìµœì í™”

- ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë”© -> propsê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìì‹ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ ë°©ì§€

- ë¦¬ì•¡íŠ¸ ê°œë°œì ë„êµ¬

  - Highlight updates when components render
    - ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ

  ![img](./1.png)

#### 1. ì‚¬ìš©ë²•

1. **React.memo ê¸°ë³¸ ì‚¬ìš©**

   - `React.memo`ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ë©´ **propsê°€ ë³€ê²½ë˜ì§€ ì•Šì„ ë•Œ** ë¦¬ë Œë”ë§ì„ ë°©ì§€.
   - **ì½”ë“œ**:

     ```js
     import { memo } from "react"

     const Header = () => {
       return <h1>ì˜¤ëŠ˜ ë‚ ì§œëŠ” {new Date().toDateString()}</h1>
     }

     export default memo(Header)
     ```

2. **React.memo + props ë¹„êµ í•¨ìˆ˜**

   - `React.memo`ì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ **props ë¹„êµ í•¨ìˆ˜**ë¥¼ ì „ë‹¬í•´ **ë¦¬ë Œë”ë§ ì¡°ê±´**ì„ ì„¸ë°€í•˜ê²Œ ì¡°ì •.
   - **ì½”ë“œ**:
     ```js
     export default memo(TodoItem, (prevProps, nextProps) => {
       // Props ë³€ê²½ ì—¬ë¶€ íŒë‹¨
       return prevProps.id === nextProps.id && prevProps.isDone === nextProps.isDone && prevProps.content === nextProps.content && prevProps.date === nextProps.date
     })
     ```

3. **ì£¼ì˜ì : React.memoì˜ ì–•ì€ ë¹„êµ**
   - ê¸°ë³¸ì ìœ¼ë¡œ **ì–•ì€ ë¹„êµ**ë¥¼ ìˆ˜í–‰í•˜ì—¬ **ê°ì²´ íƒ€ì… props**ì˜ ë‚´ë¶€ ê°’ì€ ë¹„êµí•˜ì§€ ì•ŠìŒ.
   - **í•´ê²°ë²•**:
     1. `useMemo`ë‚˜ `useCallback`ìœ¼ë¡œ props ê°’ì„ ë©”ëª¨ì´ì œì´ì…˜.
     2. ë¹„êµ í•¨ìˆ˜ë¡œ propsë¥¼ ì§ì ‘ ë¹„êµ.

---

#### 2. ì£¼ìš” ì½”ë“œ ì„¤ëª…

1. **Header ì»´í¬ë„ŒíŠ¸ (React.memo)**:

   - ë‚ ì§œë¥¼ í‘œì‹œí•˜ëŠ” **Header ì»´í¬ë„ŒíŠ¸**ëŠ” propsê°€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ ë¦¬ë Œë”ë§ì„ ë°©ì§€.
   - **ì½”ë“œ**:

     ```js
     const Header = () => {
       return (
         <div className="Header">
           <h3>ì˜¤ëŠ˜ì€ ğŸ“†</h3>
           <h1>{new Date().toDateString()}</h1>
         </div>
       )
     }

     export default memo(Header)
     ```

2. **TodoItem ì»´í¬ë„ŒíŠ¸ (React.memo + ê¹Šì€ ë¹„êµ)**:

   - Todoì˜ ë‚´ìš©, ìƒíƒœ, ë‚ ì§œ ë“±ì˜ ë³€í™”ê°€ ì—†ìœ¼ë©´ ë¦¬ë Œë”ë§ì„ ë°©ì§€.
   - **ì½”ë“œ**:
     ```js
     export default memo(TodoItem, (prevProps, nextProps) => {
       return prevProps.id === nextProps.id && prevProps.isDone === nextProps.isDone && prevProps.content === nextProps.content && prevProps.date === nextProps.date
     })
     ```

3. **React.memoì˜ ê¸°ë³¸ ë™ì‘**:
   - ê¸°ë³¸ì ìœ¼ë¡œ **props ë³€ê²½ ì—¬ë¶€ë¥¼ ì–•ì€ ë¹„êµ**ë¡œ íŒë‹¨.
   - propsê°€ ê°ì²´ë‚˜ í•¨ìˆ˜ì¼ ê²½ìš° ë§¤ë²ˆ ìƒˆë¡œìš´ ì°¸ì¡°ë¥¼ ê°€ë¦¬ì¼œ ë¦¬ë Œë”ë§ ê°€ëŠ¥.

---

#### 3. ìµœì í™” ìš”ì•½

| ê¸°ëŠ¥                           | ì„¤ëª…                                                               |
| ------------------------------ | ------------------------------------------------------------------ |
| **React.memo**                 | propsê°€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë©”ëª¨ì´ì œì´ì…˜í•˜ì—¬ ë¦¬ë Œë”ë§ ë°©ì§€. |
| **ì–•ì€ ë¹„êµ**                  | ê¸°ë³¸ì ìœ¼ë¡œ propsì˜ ì–•ì€ ë¹„êµ ìˆ˜í–‰.                                 |
| **props ë¹„êµ í•¨ìˆ˜**            | `memo(Component, ë¹„êµ í•¨ìˆ˜)`ë¡œ propsì˜ ê¹Šì€ ë¹„êµ ìˆ˜í–‰ ê°€ëŠ¥.        |
| **useMemo / useCallback ì‚¬ìš©** | ê°ì²´ë‚˜ í•¨ìˆ˜ propsë¥¼ ë©”ëª¨ì´ì œì´ì…˜í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€.       |

---

#### 4. ë³µìŠµ í¬ì¸íŠ¸

1. **React.memo ê¸°ë³¸ ì‚¬ìš©**:
   - `memo(Component)`ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì„œ props ë³€ê²½ ì‹œì—ë§Œ ë¦¬ë Œë”ë§.
2. **props ë¹„êµ í•¨ìˆ˜ ì¶”ê°€**:
   - `memo(Component, ë¹„êµ í•¨ìˆ˜)`ë¡œ propsë¥¼ ì„¸ë°€í•˜ê²Œ ë¹„êµ.
3. **ì–•ì€ ë¹„êµì˜ í•œê³„ í•´ê²°**:
   - `useMemo`ì™€ `useCallback`ìœ¼ë¡œ propsë¥¼ ë©”ëª¨ì´ì œì´ì…˜í•˜ì—¬ ìµœì í™”.

---

## useCallbackê³¼ í•¨ìˆ˜ ì¬ìƒì„± ë°©ì§€

- memoë©”ì„œë“œëŠ” ë§¤ ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ ì ìš©í•´ì•¼í•´ì„œ ê·€ì°®ìŒ -> useCallback!!

---

#### 1. ì‚¬ìš©ë²•

1. **ê¸°ë³¸ êµ¬ì¡°**:

   ```js
   const memoizedCallback = useCallback(
     () => {
       // ë©”ëª¨ì´ì œì´ì…˜ëœ í•¨ìˆ˜ ë¡œì§
     },
     [deps] // ì˜ì¡´ì„± ë°°ì—´
   )
   ```

2. **ì˜ì¡´ì„± ë°°ì—´ (deps)**:
   - ë°°ì—´ ë‚´ ê°’ì´ ë³€ê²½ë˜ë©´ í•¨ìˆ˜ê°€ ìƒˆë¡œ ìƒì„±.
   - ë¹ˆ ë°°ì—´(`[]`)ì„ ë„£ìœ¼ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë Œë”ë§ë  ë•Œ í•œ ë²ˆë§Œ ìƒì„±.

---

#### 2. ì½”ë“œ ì ìš©

1. **`onCreate` í•¨ìˆ˜**:

   - ìƒˆë¡œìš´ Todoë¥¼ ì¶”ê°€.
   - ë©”ëª¨ì´ì œì´ì…˜ëœ í•¨ìˆ˜ë¥¼ í†µí•´ ì¬ìƒì„± ë°©ì§€.
   - **ì½”ë“œ**:
     ```js
     const onCreate = useCallback((content) => {
       dispatch({
         type: "CREATE",
         data: {
           id: idRef.current++,
           isDone: false,
           content: content,
           date: new Date().getTime(),
         },
       })
     }, []) // ì˜ì¡´ì„± ë°°ì—´ì´ ë¹ˆ ë°°ì—´ì´ë¯€ë¡œ ìµœì´ˆ ë Œë”ë§ ì‹œì—ë§Œ ìƒì„±
     ```

2. **`onUpdate` í•¨ìˆ˜**:

   - Todo ìƒíƒœ(isDone) ì—…ë°ì´íŠ¸.
   - **ì½”ë“œ**:
     ```js
     const onUpdate = useCallback((targetId) => {
       dispatch({
         type: "UPDATE",
         targetId: targetId,
       })
     }, []) // ì˜ì¡´ì„± ë°°ì—´
     ```

3. **`onDelete` í•¨ìˆ˜**:
   - Todo ì‚­ì œ ì²˜ë¦¬.
   - **ì½”ë“œ**:
     ```js
     const onDelete = useCallback((targetId) => {
       dispatch({
         type: "DELETE",
         targetId: targetId,
       })
     }, []) // ì˜ì¡´ì„± ë°°ì—´
     ```

---

#### 3. ì£¼ìš” ì½”ë“œ ë¹„êµ

| **ê¸°ëŠ¥**    | **ê¸°ì¡´ í•¨ìˆ˜**                               | **`useCallback` ì‚¬ìš©**                       |
| ----------- | ------------------------------------------- | -------------------------------------------- |
| ìƒì„± ì‹œì    | ë Œë”ë§ë  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±                   | ì˜ì¡´ì„± ë°°ì—´ì´ ë³€ê²½ë  ë•Œë§Œ ìƒˆë¡œ ìƒì„±          |
| ì„±ëŠ¥ ìµœì í™” | ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë§¤ë²ˆ ë¦¬ë Œë”ë§ë  ê°€ëŠ¥ì„± ìˆìŒ | ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ë¦¬ë Œë”ë§ë˜ì§€ ì•ŠìŒ |

---

#### 5. ë³µìŠµ í¬ì¸íŠ¸

1. **`useCallback` ë¬¸ë²•**:

   ```js
   const memoizedFunction = useCallback(() => {
     // ë¡œì§
   }, [deps])
   ```

2. **ì ìš© ìœ„ì¹˜**:

   - ìì‹ ì»´í¬ë„ŒíŠ¸ì— ì „ë‹¬ë˜ëŠ” í•¨ìˆ˜ props.
   - ì˜ì¡´ì„±ì´ ì ì€ ìƒíƒœì—ì„œ ì£¼ë¡œ ì‚¬ìš©.

3. **ì„±ëŠ¥ ìµœì í™” íš¨ê³¼**:
   - ë™ì¼í•œ ì°¸ì¡°ë¥¼ ìœ ì§€í•´ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€.
   - ë Œë”ë§ ë¹„ìš© ê°ì†Œ.

---

## ìµœì í™”

1. ê¸°ëŠ¥ êµ¬í˜„ -> 2. ìµœì í™”

2. ìµœì í™” ëŒ€ìƒ

- ë³µì¡í•œ ì»´í¬ë„ŒíŠ¸ì •ë„ë§Œ ìµœì í™” ìˆ˜í–‰ ê¶Œì¥

- ìµœì í™”ê°€ í•„ìš”í•œ ê²ƒë§Œ í•˜ê¸°

- ì•„í‹°í´ "When to use useMemo, useCallback"

  https://goongoguma.github.io/2021/04/26/When-to-useMemo-and-useCallback/
